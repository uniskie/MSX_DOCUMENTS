> [!WARNING]
> **工事中**
>
> 間違いや勘違いが明らかで訂正が必要な箇所や、
> 検証が必要な箇所を含みます。

# MSXの音源：環境による音の違い

同じグループでまとめてみました。

実際に使ったり聞いてりした感触を補足で添えてありますが、自分の感覚なので違う感じ方の人もいると思います。

---

## 1. 癖が強いフィルタ

良い音が出るけど、独特過ぎて、データの互換性に心配がある物。

- blueMSX  
  ![](img/bluebanner.gif)]
  http://bluemsx.msxblue.com/jindex.htm

  → blueMSXで作った楽曲データは他の環境では同じように鳴らない。  

  2009年で更新が止まっているが、総合的にはopenMSXよりも安定して使いやすい。  
  何よりキーボードの問題が無い。

  音が太く伸びて低音がかなり響く。

  とても良い音が鳴るが、良い音が鳴りすぎとも言える。  

> [!CAUTION]
> OPLLのリズム音が小さいのは致命的な問題。  
> Vコマンドで言えば3以上低いため、他の環境で聞くと泣くことになる。

個人的にはこのようにアンプで音を弄りまくったような音を聴くのも大好きなのだけど、エミュレータ側でそれに固定されてしまうと困りますね。

---

## 2. アナログフィルタ無し

無改造の実機で表現可能な音を全域カバーできる訳ではない。  
音色そのものが変わる。

高周波域が増えて中音域が邪魔される傾向がみられ。  
無改造の実機では良い音に聞こえた音が耳障りで使えない事もある。

> [!NOTE]
> 既存曲データを聴いていると  
> 無改造実機に比べて逆に音が悪くなったと感じる事もしばしばあるため、  
> 個人的には、ピーキーな音が出る別の音源として楽しむ感覚。
> 
> 音の互換性・再現としては問題であり、  
> これを高音質化と言うのも疑問ではある。

> [!CAUTION]
> 音域によってはVコマンドで1～2の違いがあり、
> 実機で作られたデータを聞くと破綻して泣きたくなることもある。  
> OPLLリズム音などは特に分かりやすい違いが見られる。

blueMSXとは対極にある音。

最近ではopenMSXやMSXPlayなどで作成されるデータが増えてきたので、
それらのデータを聴くには適している。  

（※ MSXPlayはアナログフィルタも使用可能で、アナログフィルタ前提で作り込んだデータは当然破綻しやすい。）

- openMSX  
  https://openmsx.org/  
  ![](img/penguin.gif)

  互換性の高いNuked YM2413を採用  
  version 20.0でGUIを刷新。  
  強力なデバッガや各種機能が統合され、非常に使いやすくなった。  
  一方でキー入力できないキーが存在するという致命的な問題は未解決。  
  （昔は使えたのに何故変えたのか…）

- 1chipMSX  
  ![](img/ichipmsx.gif)  
  （クローン：ZeminaxNeo、SM-X、SX-1、SX-1 mini、SX2、SX-E、SX-LITE等も同様）  

  ※ 公式版はVDP、PSG、OPLL全てに問題がある為、OCM-PLD改への書き換え推奨

  > 公式版は互換性が低く実用には厳しかったが、添付されたファームウェアをユーザーが修正することができた為、有志が10年近く改良を続け、現在では最も使いやすいMSXと言っても過言ではない。

  > SDカード対応、VDPの高速コピーモード、実行時の動作クロック変更、外部スロットの実行時切替など非常に有用な機能を搭載。

  最新ファームウェアは OCM-PLD 3.9.1で、MSX++の呼称を送られている。  
  ※ 3.9.2は現在正式リリースに向けてテストを重ねて準備中。  
  https://gnogni.altervista.org/

  - PSGやOPLLの音量ミキシング問題を修正済み。  
  - OPLLは最新のVM2413。


- 積分回路のコンデンサC12、C13を除去したFMPAC
  ![](img/myfmpac.jpg)  
  （※ 画像中の茶色のテープを巻いたコンデンサを外す）

  せっかくのFMPAC実物であるのに、  
  わざわざエミュレーション音源に近づける意義は感じない。

- FPGAやPICを使用したハードウェアエミュレーション音源
- 
  現行品ではアナログ音声フィルタ部分まで再現したものは無い様子。
  
  （FMPAC互換カートリッジとされるものの中にはフィルタを再現しているものがあるかもしれない）

エミュレーション精度が上がった現在では、  
フィルタなしのOPLLの音を聞きたければopenMSXが最も余計なノイズが少ない。

実機向けデバイスの場合、音質問題は基本的にノイズの混入であり、アナログフィルタを弄ったところで改善されない。

ただし、エミュレーション音源環境で作りこまれた曲データが増えてきたため、  
それを実機で再現したい場合はフィルタなし実機向けデバイスも需要がある。

---

## 3. 従来の「高音質化改造」

積分回路やLPFの効果を弱めにする改造が施された実機・デバイス。

積分回路・LPFが存在しない場合と同様に、  
無改造で表現可能な音を全てカバーできるわけではない為、
高音質化と言うのは疑問がある。

中音域で暴れて高音域でいきなり音が詰まるという半端な調整になり易い。

音量バランスも当然別物になり、  
無改造環境で作られたデータを聴くと破綻しやすい。

（LPFだけでなく、積分回路を変更するものは特に）

- 音質改善実機  
  http://frs.badcoffee.info/hardware/MSXfixes.html 等

- 音質改善FMPAC  
  C17：1μF→4.7μF 50V 無極性  
  C12、C13：0.015μF→1500pF  等


他の回路から混入するノイズの除去する以外の改造は、  
ただ単に音の特性を変える改造に過ぎない。

他にも
- 改造方法によっても音の特性がまちまち。
- ハードルが高く、実行する人は少ない。
- つまり、音源データの再現性が低い。

という問題がある。

「人にもなれず化け物にもなれず」というのが個人的感想。

> [!NOTE]
> 精度の高いエミュレーション音源や、ノイズ排除タイプの高音質音源カートリッジの出現により、従来の高音質化改造の意義は薄くなったように思う。

> #### 個人的なOPLLでの音作りに対する考え
> 
> 積分回路に使用される0.015μFは必要以上に強いという説があるが、  
> 段階的に容量を変えて聞き比べた感想としては、  
> 魅力的で色気のある音に変わる分岐点で、とても良い選択のように感じた。
>
> OPLLの音は2オペなので音色パラメータを弄った時の表現の幅は狭いため、  
> 積分回路による音の変化が加わることで幅が広がるように思う。
> 
> 音作りの選択肢としては
> 1. フィルタ無しでギリギリを攻める
> 2. 積分回路とセットで中音域のなめらかな伸びを引き出す
>
> のどちらかの選択肢になる。
> 
> その点、フィルタを弱めに調整する改造は、
> 音作りに対するメリットが最も少ない。再現性も低い。
>
> 音がこもっているという感想がLPFに起因するのであれば、  
> 積分回路部の0.015μFを弄るよりも、  
> LPFの220pFを小さい容量に変更する方が良いように思うが、  
> その場合も、結局は音の特性が変わるだけで音質の変化かと言われると疑問が残る。
> 
> （ちなみに、HB-F1XVのLPFは100pFを使用していて、FMPACよりも低い周波数帯域から滑らかに減衰するとのこと。）

## 4. ノイズ低減 高音質化カートリッジ

ノイズの問題はFDDや映像からのノイズの混入などで、対策改造が難しい。  
その問題を解決するべく、新しいカートリッジが発表されている。

本体のノイズから分離されたノイズフリーな音をカートリッジから出力可能なデバイス。

各音源のミキシング音量バランスが調整可能になっていて、  
機種毎の音量バランス違い問題も解決。

MSXでの音楽演奏に付きまとう様々な問題を解決してしまう
令和のスーパーアイテム。

同じデバイスを購入すれば、誰でも同じ音で聞く事ができる。


- にがさんの「**SundCoreSlotEX**」（通称：核スロ）  
  http://niga2.sytes.net/sp/coreslot.pdf  
  ![](img/sound_core_slot_ex.png)

  > 本機は MSX 対応の FFM+PSG 音源付き拡張スロッ
トです。YAMAHA の音源LSI「YM2413」と「YMZ294」
を搭載。MSX-MUSIC 互換、本体内蔵 PSG 互換です
ので、従来のゲームソフトやアプリケーションで低ノ
イズの綺麗なサウンドをお楽しみいただけます。

- Lost Technologyさんの「**MSX SOUND ENHANCER**」  
  https://sites.google.com/site/lostechmsx/home/products/msx_sound_enhancer_rev2  
  ![](img/msx_sound_enhancer.jpg)

  > 「MSXの機種ごとに音量バランスやら音質やら信号特性やらがバラバラ」な問題を解決！  
  > 主な特長  
  > - 実音源チップ（PSGおよびFM音源）をボード上に搭載  
  > - 既存ソフトと（だいたい）互換
  > - PSG/OPLL/SCCの音量を独立して設定可能
  > - 機種ごとにバラバラな音声特性を改善
  > - サラウンドプロセッサ搭載により疑似ステレオ化
  > - 外部電源の供給により高音質を実現（ACアダプタ別売り）
  > - 音源のマスタークロックを外部から供給可能（オプション）
  > - YMF281、YM2423などのOPLLファミリーを既存ソフトで駆動可能（オプション）

> [!CAUTION]
> 設計思想的にアナログフィルタ部分も再現してあると思われるが、  
> 当方は未確認の為、動画などを各自参照して判断されたし。

---

## 5. アナログフィルタを使用可能なエミュレーション音源

- WinAMP + MSXPlug または、kbMediaPlayer  
  https://github.com/digital-sound-antiques/in_msx  
  https://kobarin.sakura.ne.jp/kbmedia/kbmedia.htm
  
  - RCフィルタ（LPF）の有効化・無効化・パラーメータ調整が可能。  

    ![](img/MSXPlug-filter.png)
    （プラグイン設定>フィルタ>アナログフィルタ>RCフィルタ）
    - 実機に近い音になる。
    - ただし、OPLLだけではなくPSGやSCCも含めて全体に掛かってしまう。
    - デフォルトではOFFになっていることが多い。
  - PSGのタイプをAY-3-8910かYM2413（MSX-Engine/SSG）から選べる  
    ![](img/MSXPlug-device.png)

- m3Disp  
  https://m3.ym2413.com/
  
  内部的にはMSXPlugを使用。  
  設定変更機能は無い。
  - デフォルトはDCフィルタのみでOFF?
  - PSGタイプはおそらくYM2413(SSG)

- MSXPlay  
  https://msxplay.com/editor.html
  
  内部的にはMSXPlugを使用。  
  LPFのON/OFFが選択可能。  
  こちらもOPLLだけではなくPSGやSCCにもフィルタがかかる。

音源エミュレータの中では、実機との違和感が最も少ない。  
（というよりも他に実機に近い音を出せるものが無い。）

---

## 6. 無改造実機

フィルタのかかり具合や、音量バランスは機種でまちまち。

一番悩ましいのは音量バランスのばらつき。

その点、上に挙げた最近の高音質音源出力カートリッジは音量バランスの問題への対策が含まれている。

- サンヨー MSX2+
  
  PSGが大き目。  
  OPLLの音はシャープな印象。

- ソニー MSX2+
  
  PSG音量は中間ぐらい。  
  OPLLはこもりがちで、代わりに中音域が伸びる印象。  
  OPLLの音量自体は半固定抵抗で変更可能。  
  経年劣化していく問題が有名。

- パナソニック MSX2+/turboR
  
  PSG小さめ。  
  全体に音が少し丸い。  
  映像端子のつなぎ方によってはノイズが多い。

  A1GTはWXよりもノイズが多いという噂。

- MX-101（番外）
  
  PSGはカスタムチップでSSGに近い。  
  外部音源に対してPSG音量がかなり低い。  
  Vコマンドで4ぐらい違う。  
  SCC音源を使用したゲームだとPSGパートがほぼ聞こえない。

  PSGの汎用I/Oの仕様が一部未実装

- MX-10/FS-A1（番外）
  
  バランスが良い。  
  本体がコンパクト。  
  MX-10のPSGはGI AY-3-8910  
  A1はMSX-ENGINE（SSG）  
  OPLLはFMAPCを使用する。（MX-10はKB-10か12V電源の追加が必要）  

> [!NOTE]
> FMPACの音量：  
> 内蔵機種に比べて音量小だと小さすぎ、中だと大きい為、意外と取り扱いが難しい。

---

# MSXのOPLL(YM2413)

## OPLLとローパスフィルタ

> YM2413アプリケーションマニュアルより引用  
> http://d4.princess.ne.jp/msx/datas/OPLL/YM2413AP.html
>
> 4-2.オーディオ出力
OPLLの音声出力は、以前に記述されるようなパルス信号のため、外付けの積分回路が必要です。この積分回路の出力(またバッファー)は、オーディオ・アンプに直接接続されるでしょう。また、積分回路とアンプの間に低域フィルター(遮断周波数: 20kHz程度)を挿入することにより、ステップノイズを削除することができ、高音質化が計れます。電源ON/OFF時にノイズが発生するため、オーディオ機器(アンプやスピーカー)を保護する回路が必要です。  
> ![](img/ym2413_apprication_manual_fig4-2.png)  
> 図4-2 オーディーインターフェース

PCM等は複数ビットで構成されたデジタル信号レベルが出力されますが、YM2413の出力は1ビットのパルス信号なので、D/A変換では外付けの積分回路を使用します。

D/A変換後に低域フィルター（=ローパスフィルタ/LPF）を挿入するのは[ステップノイズ](#ステップノイズ)を削減するためのようです。

> #### ステップノイズ
> 階段状の変化をする信号は連続的な変化の中で尖った成分が混じっているように感じる。
> 
> コンピュータグラフィックスで言えばエイリアシングやジャギーなどと呼ばれる物で、アンチエイリアシングがLPF相当。

## にがMSX ～ FS-A1の改造 ～

http://niga2.sytes.net/msx/A1RED_KAI.html

にがさんのFS-A1改造記事

A1にOPLLを内蔵する部分で、OPLLの積分回路、LPF、アンプそれぞれの各機種での実装について詳細な説明と解析結果が記されています。

> 例）アンプ増幅回路の違い
> |機種|増幅量|
> |---|---|
> | FMPAC | 小が約3倍、中が5倍、大が10倍 |
> | Panasonic FS-A1WX | 7倍固定 |
> | SONY HB-F1XV | 半固定抵抗で0～20倍 |

> 例）FMPACとHB-F1XVのLPF比較
> ![FMPACとHB-F1XVのLPF比較](img/niga-lpf-comparrison.png)
> （にがさんの記事より引用）
> 
> ソニーはカットされる範囲が多めで丸く太い音という印象でしたが、実際にデータで確認することが出来ました。


## FMPAC SW-M004 回路図

[BABAXさん](https://x.com/bax01tw)制作のFMPAC回路図  

（リンク切れ）https://green.ap.teacup.com/junker/160.html

（teacupのホームページサービス終了に伴い、幾つかの記事はblogに移植されてるものの、FMPACの記事は不明。）

幸い回路図は現在のblog管理下に移行されている。  
https://elec-junker-p2.blog.jp/tea/FMPAC_02a.pdf  
![BABAXさん制作FMPAC回路図](img/FMPAC_circuit_02a.png)

### よくあったFMPAC音質変更改造

以前教えてもらったのが  
- C17：1μF→4.7μF 50V 無極性
- C12、C13：0.015μF→1500pF

という改造。

実際にこの変更を行って色々聞き比べた結果、  
C12、C13は外してしまうか、元の0.015μFのどちらかが良いというのが個人的な感想。  

外した場合は、エミュ―レータに近い音が鳴る。

![FMPAC_circuit_02a_c12_c13_c17.png](img/FMPAC_circuit_02a_c12_c13_c17.png) (回路図より該当箇所付近を一部抜粋)

こうしてみると、C12、C13は積分回路と思われる。  
LPFではないものの、バッファなのでここを変更すると音の丸みが変化する。  
（効果的にはRCローパスフィルタも兼任している？）

LPF自体はC15の220μFのコンデンサと思われる。  
（にがさんのA1改造記事内、FMPACとHB-F1XVのLPF比較のコメント参照）

C17は記憶が確かならHPF。  
（起動時に出る低音域の大きなノイズを抑制する）

実際に、改造して試してみて自分が思ったのは、改造しても音質は良くならないから、  
勿体ないので、改造はしなくて良いという事。

本体やFMPACを改造するよりも、ノイズや音量バランス対策のされた高音質カートリッジをお勧めしたい。

また、1chipMSXやOpenMSXで作成されたものを実行（演奏）するであれば、エミュレータが最適解。

→ カン違い等、ご指摘いただければ幸い。


